var t,n,r,i,e=require("gl-matrix/vec3"),u=require("gl-matrix/mat4");function s(){return(s=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t}).apply(this,arguments)}function o(t,n){t.prototype=Object.create(n.prototype),t.prototype.constructor=t,h(t,n)}function h(t,n){return(h=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t,n){(null==n||n>t.length)&&(n=t.length);for(var r=0,i=new Array(n);r<n;r++)i[r]=t[r];return i}function a(t,n){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,n){if(t){if("string"==typeof t)return c(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){r&&(t=r);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(r=t[Symbol.iterator]()).next.bind(r)}function v(t,n,r,i){var e,u=arguments.length,s=u<3?n:null===i?i=Object.getOwnPropertyDescriptor(n,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,n,r,i);else for(var o=t.length-1;o>=0;o--)(e=t[o])&&(s=(u<3?e(s):u>3?e(n,r,s):e(n,r))||s);return u>3&&s&&Object.defineProperty(n,r,s),s}(t=exports.PropertyType||(exports.PropertyType={})).ACCESSOR="Accessor",t.ANIMATION="Animation",t.ANIMATION_CHANNEL="AnimationChannel",t.ANIMATION_SAMPLER="AnimationSampler",t.BUFFER="Buffer",t.CAMERA="Camera",t.MATERIAL="Material",t.MESH="Mesh",t.PRIMITIVE="Primitive",t.PRIMITIVE_TARGET="PrimitiveTarget",t.NODE="Node",t.ROOT="Root",t.SCENE="Scene",t.SKIN="Skin",t.TEXTURE="Texture",t.TEXTURE_INFO="TextureInfo",(n=exports.VertexLayout||(exports.VertexLayout={})).INTERLEAVED="interleaved",n.SEPARATE="separate",(r=exports.TextureChannel||(exports.TextureChannel={}))[r.R=4096]="R",r[r.G=256]="G",r[r.B=16]="B",r[r.A=1]="A",(i=exports.Format||(exports.Format={})).GLTF="GLTF",i.GLB="GLB";var l=function(){function t(t,n,r){if(this.t=void 0,this.i=void 0,this.u=void 0,this.h=!1,this.l=[],this.t=t,this.i=n,this.u=r,!n.canLink(r))throw new Error("Cannot link disconnected graphs/documents.")}var n=t.prototype;return n.getName=function(){return this.t},n.getParent=function(){return this.i},n.getChild=function(){return this.u},n.setChild=function(t){return this.u=t,this},n.dispose=function(){this.h||(this.h=!0,this.l.forEach(function(t){return t()}),this.l.length=0)},n.onDispose=function(t){return this.l.push(t),this},n.isDisposed=function(){return this.h},t}(),d=function(){function t(){this.p=new Set,this.m=new Set,this.T=new Map,this.I=new Map,this.l={}}var n=t.prototype;return n.on=function(t,n){return this.l[t]=this.l[t]||[],this.l[t].push(n),this},n.emit=function(t,n){for(var r,i=a(this.l[t]||[]);!(r=i()).done;)(0,r.value)(n);return this},n.getLinks=function(){return Array.from(this.m)},n.listParentLinks=function(t){return Array.from(this.I.get(t)||this.p)},n.listParents=function(t){return this.listParentLinks(t).map(function(t){return t.getParent()})},n.listChildLinks=function(t){return Array.from(this.T.get(t)||this.p)},n.listChildren=function(t){return this.listChildLinks(t).map(function(t){return t.getChild()})},n.disconnectChildren=function(t){return(this.T.get(t)||this.p).forEach(function(t){return t.dispose()}),this},n.disconnectParents=function(t,n){var r=Array.from(this.I.get(t)||this.p);return n&&(r=r.filter(function(t){return n(t.getParent())})),r.forEach(function(t){return t.dispose()}),this},n.swapChild=function(t,n,r){var i=this,e=this.T.get(t)||this.p;return Array.from(e).filter(function(t){return t.getChild()===n}).forEach(function(t){i.I.get(n).delete(t),t.setChild(r),i.I.has(r)||i.I.set(r,new Set),i.I.get(r).add(t)}),this},n.link=function(t,n,r){if(!r)return null;var i=new l(t,n,r);return this.registerLink(i),i},n.registerLink=function(t){var n=this;this.m.add(t);var r=t.getParent();this.T.has(r)||this.T.set(r,new Set),this.T.get(r).add(t);var i=t.getChild();return this.I.has(i)||this.I.set(i,new Set),this.I.get(i).add(t),t.onDispose(function(){return n.unlink(t)}),t},n.unlink=function(t){return this.m.delete(t),this.T.get(t.getParent()).delete(t),this.I.get(t.getChild()).delete(t),this},t}();function w(t,n){Object.defineProperty(t,n,{get:function(){return this["__"+n]},set:function(t){var r=this,i=this["__"+n];i&&!Array.isArray(i)&&i.dispose(),t&&!Array.isArray(t)&&t.onDispose(function(){r["__"+n]=null}),this["__"+n]=t},enumerable:!0})}function p(t,n){}var x=function(){function t(t){this.graph=void 0,this.h=!1,this.graph=t,this.graph=t}var n=t.prototype;return n.canLink=function(t){return this.graph===t.graph},n.isDisposed=function(){return this.h},n.dispose=function(){this.graph.disconnectChildren(this),this.graph.disconnectParents(this),this.h=!0,this.graph.emit("dispose",this)},n.detach=function(){return this.graph.disconnectParents(this),this},n.swap=function(t,n){return this.graph.swapChild(this,t,n),this},n.addGraphChild=function(t,n){return t.push(n),n.onDispose(function(){var r=t.filter(function(t){return t!==n});t.length=0;for(var i,e=a(r);!(i=e()).done;)t.push(i.value)}),this},n.removeGraphChild=function(t,n){return t.filter(function(t){return t.getChild()===n}).forEach(function(t){return t.dispose()}),this},n.clearGraphChildList=function(t){for(;t.length>0;)t[0].dispose();return this},n.listGraphParents=function(){return this.graph.listParents(this)},t}();function y(t,n){for(var r,i={min:[Infinity,Infinity,Infinity],max:[-Infinity,-Infinity,-Infinity]},u=a(t.listPrimitives());!(r=u()).done;){var s=r.value.getAttribute("POSITION");if(s)for(var o=[0,0,0],h=[0,0,0],f=0;f<s.getCount();f++)o=s.getElement(f,o),A(h=e.transformMat4(h,o,n),i)}return i}function A(t,n){for(var r=0;r<3;r++)n.min[r]=Math.min(t[r],n.min[r]),n.max[r]=Math.max(t[r],n.max[r])}var E=function(){function t(){}return t.createBufferFromDataURI=function(t){if("undefined"==typeof Buffer){for(var n=atob(t.split(",")[1]),r=new Uint8Array(n.length),i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r.buffer}var e=t.split(",")[1],u=t.indexOf("base64")>=0;return this.trim(Buffer.from(e,u?"base64":"utf8"))},t.encodeText=function(t){return"undefined"!=typeof TextEncoder?(new TextEncoder).encode(t).buffer:this.trim(Buffer.from(t))},t.decodeText=function(t){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(t):Buffer.from(t).toString("utf8")},t.trim=function(t){var n=t.byteOffset;return t.buffer.slice(n,n+t.byteLength)},t.concat=function(t){for(var n,r=0,i=a(t);!(n=i()).done;)r+=n.value.byteLength;for(var e,u=new Uint8Array(r),s=0,o=a(t);!(e=o()).done;){var h=e.value;u.set(new Uint8Array(h),s),s+=h.byteLength}return u.buffer},t.pad=function(t,n){void 0===n&&(n=0);var r=this.padNumber(t.byteLength);if(r!==t.byteLength){var i=new Uint8Array(r);if(i.set(new Uint8Array(t)),0!==n)for(var e=t.byteLength;e<r;e++)i[e]=n;return i.buffer}return t},t.padNumber=function(t){return 4*Math.ceil(t/4)},t.equals=function(t,n){if(t===n)return!0;if(t.byteLength!==n.byteLength)return!1;for(var r=new DataView(t),i=new DataView(n),e=t.byteLength;e--;)if(r.getUint8(e)!==i.getUint8(e))return!1;return!0},t}(),m=function(){function t(){}return t.hexToFactor=function(t,n){t=Math.floor(t);var r=n;return r[0]=(t>>16&255)/255,r[1]=(t>>8&255)/255,r[2]=(255&t)/255,this.convertSRGBToLinear(n,n)},t.factorToHex=function(t){var n=[].concat(t),r=this.convertLinearToSRGB(t,n);return 255*r[0]<<16^255*r[1]<<8^255*r[2]<<0},t.convertSRGBToLinear=function(t,n){for(var r=t,i=n,e=0;e<3;e++)i[e]=r[e]<.04045?.0773993808*r[e]:Math.pow(.9478672986*r[e]+.0521327014,2.4);return n},t.convertLinearToSRGB=function(t,n){for(var r=t,i=n,e=0;e<3;e++)i[e]=r[e]<.0031308?12.92*r[e]:1.055*Math.pow(r[e],.41666)-.055;return n},t}(),b=function(){function t(){}return t.basename=function(t){var n=t.split(/[\\/]/).pop();return n.substr(0,n.lastIndexOf("."))},t.extension=function(t){return 0!==t.indexOf("data:")?t.split(/[\\/]/).pop().split(/[.]/).pop():0===t.indexOf("data:image/png")?"png":0===t.indexOf("data:image/jpeg")?"jpeg":"bin"},t}(),T=function(){function t(){}var n=t.prototype;return n.getSize=function(t){for(var n,r,i=new DataView(t,4);i.byteLength;){if(n=i.getUint16(0,!1),M(i,n),192===(r=i.getUint8(n+1))||193===r||194===r)return[i.getUint16(n+7,!1),i.getUint16(n+5,!1)];i=new DataView(t,i.byteOffset+n+2)}throw new TypeError("Invalid JPG, no size found")},n.getChannels=function(t){return 3},t}(),I=function(){function t(){}var n=t.prototype;return n.getSize=function(n){var r=new DataView(n);return E.decodeText(n.slice(12,16))===t.PNG_FRIED_CHUNK_NAME?[r.getUint32(32,!1),r.getUint32(36,!1)]:[r.getUint32(16,!1),r.getUint32(20,!1)]},n.getChannels=function(t){return 4},t}();I.PNG_FRIED_CHUNK_NAME="CgBI";var g=function(){function t(){}return t.registerFormat=function(t,n){this.impls[t]=n},t.getSize=function(t,n){return this.impls[n]?this.impls[n].getSize(t):null},t.getChannels=function(t,n){return this.impls[n]?this.impls[n].getChannels(t):null},t.getMemSize=function(t,n){if(!this.impls[n])return null;if(this.impls[n].getGPUByteLength)return this.impls[n].getGPUByteLength(t);var r=0,i=this.getSize(t,n);if(!i)return null;for(;i[0]>1||i[1]>1;)r+=i[0]*i[1]*4,i[0]=Math.max(Math.floor(i[0]/2),1),i[1]=Math.max(Math.floor(i[1]/2),1);return r+4},t.mimeTypeToExtension=function(t){return"image/jpeg"===t?"jpg":t.split("/").pop()},t.extensionToMimeType=function(t){return"jpg"===t?"image/jpeg":"image/"+t},t}();function M(t,n){if(n>t.byteLength)throw new TypeError("Corrupt JPG, exceeded buffer limits");if(255!==t.getUint8(n))throw new TypeError("Invalid JPG, marker table corrupted");return t}g.impls={"image/jpeg":new T,"image/png":new I};var S=function(){function t(){}return t.identity=function(t){return t},t.eq=function(t,n){if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(Math.abs(t[r]-n[r])>1e-5)return!1;return!0},t.denormalize=function(t,n){switch(n){case 5126:return t;case 5123:return t/65535;case 5121:return t/255;case 5122:return Math.max(t/32767,-1);case 5120:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}},t.normalize=function(t,n){switch(n){case 5126:return t;case 5123:return Math.round(65535*t);case 5121:return Math.round(255*t);case 5122:return Math.round(32767*t);case 5120:return Math.round(127*t);default:throw new Error("Invalid component type.")}},t.decompose=function(t,n,r,i){var s=e.length([t[0],t[1],t[2]]),o=e.length([t[4],t[5],t[6]]),h=e.length([t[8],t[9],t[10]]);u.determinant(t)<0&&(s=-s),n[0]=t[12],n[1]=t[13],n[2]=t[14];var f=t.slice(),c=1/s,a=1/o,v=1/h;f[0]*=c,f[1]*=c,f[2]*=c,f[4]*=a,f[5]*=a,f[6]*=a,f[8]*=v,f[9]*=v,f[10]*=v,u.getRotation(r,f),i[0]=s,i[1]=o,i[2]=h},t.compose=function(t,n,r,i){var e=i,u=n[0],s=n[1],o=n[2],h=n[3],f=u+u,c=s+s,a=o+o,v=u*f,l=u*c,d=u*a,w=s*c,p=s*a,x=o*a,y=h*f,A=h*c,E=h*a,m=r[0],b=r[1],T=r[2];return e[0]=(1-(w+x))*m,e[1]=(l+E)*m,e[2]=(d-A)*m,e[3]=0,e[4]=(l-E)*b,e[5]=(1-(v+x))*b,e[6]=(p+y)*b,e[7]=0,e[8]=(d+A)*T,e[9]=(p-y)*T,e[10]=(1-(v+w))*T,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},t}(),R=function(){function t(t){this.verbosity=void 0,this.verbosity=t}var n=t.prototype;return n.debug=function(n){this.verbosity<=t.Verbosity.DEBUG&&console.debug(n)},n.info=function(n){this.verbosity<=t.Verbosity.INFO&&console.info(n)},n.warn=function(n){this.verbosity<=t.Verbosity.WARN&&console.warn(n)},n.error=function(n){this.verbosity<=t.Verbosity.ERROR&&console.error(n)},t}();R.Verbosity={SILENT:4,ERROR:3,WARN:2,INFO:1,DEBUG:0},R.DEFAULT_INSTANCE=new R(R.Verbosity.INFO);var N="23456789abdegjkmnpqrvwxyzABDEGJKMNPQRVWXYZ",O=new Set,L=function(){for(var t="",n=0;n<6;n++)t+=N.charAt(Math.floor(Math.random()*N.length));return t},P=function(){for(var t=0;t<999;t++){var n=L();if(!O.has(n))return O.add(n),n}return""},_=function(t){return t},U=function(t){function n(n,r){var i;return void 0===r&&(r=""),(i=t.call(this,n)||this).graph=void 0,i.g={},i.t="",i.graph=n,i.t=r,i}o(n,t);var r=n.prototype;return r.getName=function(){return this.t},r.setName=function(t){return this.t=t,this},r.getExtras=function(){return this.g},r.setExtras=function(t){return this.g=t,this},r.clone=function(){var t=new(0,this.constructor)(this.graph).copy(this,_);return this.graph.emit("clone",t),t},r.copy=function(t,n){return this.t=t.t,this.g=JSON.parse(JSON.stringify(t.g)),this},r.detach=function(){return this.graph.disconnectParents(this,function(t){return"Root"!==t.propertyType}),this},r.listParents=function(){return this.listGraphParents()},n}(x),j="Pass extension name (string) as lookup token, not a constructor.",B=function(t){function n(){for(var n,r=arguments.length,i=new Array(r),e=0;e<r;e++)i[e]=arguments[e];return(n=t.call.apply(t,[this].concat(i))||this).extensions=[],n}o(n,t);var r=n.prototype;return r.copy=function(n,r){var i=this;return void 0===r&&(r=_),t.prototype.copy.call(this,n,r),this.clearGraphChildList(this.extensions),n.extensions.forEach(function(t){var n=t.getChild();i.setExtension(n.extensionName,r(n))}),this},r.getExtension=function(t){if("string"!=typeof t)throw new Error(j);var n=this.extensions.find(function(n){return n.getChild().extensionName===t});return n?n.getChild():null},r.setExtension=function(t,n){if("string"!=typeof t)throw new Error(j);var r=this.getExtension(t);return r&&this.removeGraphChild(this.extensions,r),n?(n.M(this),this.addGraphChild(this.extensions,this.graph.link(t,this,n))):this},r.listExtensions=function(){return this.extensions.map(function(t){return t.getChild()})},n}(U);v([p],B.prototype,"extensions",void 0);var C=function(t){function n(){for(var r,i=arguments.length,e=new Array(i),u=0;u<i;u++)e[u]=arguments[u];return(r=t.call.apply(t,[this].concat(e))||this).propertyType=exports.PropertyType.ACCESSOR,r.S=null,r.N=n.Type.SCALAR,r.O=n.ComponentType.FLOAT,r.L=!1,r.P=S.identity,r._=S.identity,r.buffer=null,r}o(n,t);var r=n.prototype;return r.copy=function(n,r){return void 0===r&&(r=_),t.prototype.copy.call(this,n,r),this.N=n.N,this.O=n.O,this.L=n.L,this.P=n.P,this._=n._,n.S&&(this.S=n.S.slice()),this.setBuffer(n.buffer?r(n.buffer.getChild()):null),this},n.getElementSize=function(t){switch(t){case n.Type.SCALAR:return 1;case n.Type.VEC2:return 2;case n.Type.VEC3:return 3;case n.Type.VEC4:case n.Type.MAT2:return 4;case n.Type.MAT3:return 9;case n.Type.MAT4:return 16;default:throw new Error("Unexpected type: "+t)}},n.getComponentSize=function(t){switch(t){case n.ComponentType.BYTE:case n.ComponentType.UNSIGNED_BYTE:return 1;case n.ComponentType.SHORT:case n.ComponentType.UNSIGNED_SHORT:return 2;case n.ComponentType.UNSIGNED_INT:case n.ComponentType.FLOAT:return 4;default:throw new Error("Unexpected component type: "+t)}},r.getMinNormalized=function(t){var n=this.getElementSize();this.getMin(t);for(var r=0;r<n;r++)t[r]=this._(t[r]);return t},r.getMin=function(t){for(var n=this.getCount(),r=this.getElementSize(),i=0;i<r;i++)t[i]=Infinity;for(var e=0;e<n*r;e+=r)for(var u=0;u<r;u++){var s=this.S[e+u];Number.isFinite(s)&&(t[u]=Math.min(t[u],s))}return t},r.getMaxNormalized=function(t){var n=this.getElementSize();this.getMax(t);for(var r=0;r<n;r++)t[r]=this._(t[r]);return t},r.getMax=function(t){for(var n=this.getCount(),r=this.getElementSize(),i=0;i<r;i++)t[i]=-Infinity;for(var e=0;e<n*r;e+=r)for(var u=0;u<r;u++){var s=this.S[e+u];Number.isFinite(s)&&(t[u]=Math.max(t[u],s))}return t},r.getCount=function(){return this.S?this.S.length/this.getElementSize():0},r.getType=function(){return this.N},r.setType=function(t){return this.N=t,this},r.getElementSize=function(){return n.getElementSize(this.N)},r.getComponentSize=function(){return this.S.BYTES_PER_ELEMENT},r.getComponentType=function(){return this.O},r.getNormalized=function(){return this.L},r.setNormalized=function(t){var n=this;return this.L=t,t?(this._=function(t){return S.denormalize(t,n.O)},this.P=function(t){return S.normalize(t,n.O)}):(this._=S.identity,this.P=S.identity),this},r.getScalar=function(t){var n=this.getElementSize();return this._(this.S[t*n])},r.setScalar=function(t,n){return this.S[t*this.getElementSize()]=this.P(n),this},r.getElement=function(t,n){for(var r=this.getElementSize(),i=0;i<r;i++)n[i]=this._(this.S[t*r+i]);return n},r.setElement=function(t,n){for(var r=this.getElementSize(),i=0;i<r;i++)this.S[t*r+i]=this.P(n[i]);return this},r.getBuffer=function(){return this.buffer?this.buffer.getChild():null},r.setBuffer=function(t){return this.buffer=this.graph.link("buffer",this,t),this},r.getArray=function(){return this.S},r.setArray=function(t){return this.O=t?k(t):n.ComponentType.FLOAT,this.S=t,this},r.getByteLength=function(){return this.S?this.S.byteLength:0},n}(B);function k(t){switch(t.constructor){case Float32Array:return C.ComponentType.FLOAT;case Uint32Array:return C.ComponentType.UNSIGNED_INT;case Uint16Array:return C.ComponentType.UNSIGNED_SHORT;case Uint8Array:return C.ComponentType.UNSIGNED_BYTE;case Int16Array:return C.ComponentType.SHORT;case Int8Array:return C.ComponentType.BYTE;default:throw new Error("Unknown accessor componentType.")}}C.Type={SCALAR:"SCALAR",VEC2:"VEC2",VEC3:"VEC3",VEC4:"VEC4",MAT2:"MAT2",MAT3:"MAT3",MAT4:"MAT4"},C.ComponentType={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,UNSIGNED_INT:5125,FLOAT:5126},v([w],C.prototype,"buffer",void 0);var F=function(t){function n(){for(var n,r=arguments.length,i=new Array(r),e=0;e<r;e++)i[e]=arguments[e];return(n=t.call.apply(t,[this].concat(i))||this).propertyType=exports.PropertyType.ANIMATION,n.channels=[],n.samplers=[],n}o(n,t);var r=n.prototype;return r.copy=function(n,r){var i=this;return void 0===r&&(r=_),t.prototype.copy.call(this,n,r),this.clearGraphChildList(this.channels),this.clearGraphChildList(this.samplers),n.channels.forEach(function(t){return i.addChannel(r(t.getChild()))}),n.samplers.forEach(function(t){return i.addSampler(r(t.getChild()))}),this},r.addChannel=function(t){var n=this.graph.link("channel",this,t);return this.addGraphChild(this.channels,n)},r.removeChannel=function(t){return this.removeGraphChild(this.channels,t)},r.listChannels=function(){return this.channels.map(function(t){return t.getChild()})},r.addSampler=function(t){var n=this.graph.link("sampler",this,t);return this.addGraphChild(this.samplers,n)},r.removeSampler=function(t){return this.removeGraphChild(this.samplers,t)},r.listSamplers=function(){return this.samplers.map(function(t){return t.getChild()})},n}(B);v([p],F.prototype,"channels",void 0),v([p],F.prototype,"samplers",void 0);var D=function(t){function n(){for(var n,r=arguments.length,i=new Array(r),e=0;e<r;e++)i[e]=arguments[e];return(n=t.call.apply(t,[this].concat(i))||this).propertyType=exports.PropertyType.ANIMATION_CHANNEL,n.U=null,n.targetNode=null,n.sampler=null,n}o(n,t);var r=n.prototype;return r.copy=function(n,r){return void 0===r&&(r=_),t.prototype.copy.call(this,n,r),this.U=n.U,this.setTargetNode(n.targetNode?r(n.targetNode.getChild()):null),this.setSampler(n.sampler?r(n.sampler.getChild()):null),this},r.getTargetPath=function(){return this.U},r.setTargetPath=function(t){return this.U=t,this},r.getTargetNode=function(){return this.targetNode?this.targetNode.getChild():null},r.setTargetNode=function(t){return this.targetNode=this.graph.link("target.node",this,t),this},r.getSampler=function(){return this.sampler?this.sampler.getChild():null},r.setSampler=function(t){return this.sampler=this.graph.link("sampler",this,t),this},n}(U);D.TargetPath={TRANSLATION:"translation",ROTATION:"rotation",SCALE:"scale",WEIGHTS:"weights"},v([w],D.prototype,"targetNode",void 0),v([w],D.prototype,"sampler",void 0);var G=function(t){function n(){for(var r,i=arguments.length,e=new Array(i),u=0;u<i;u++)e[u]=arguments[u];return(r=t.call.apply(t,[this].concat(e))||this).propertyType=exports.PropertyType.ANIMATION_SAMPLER,r.j=n.Interpolation.LINEAR,r.input=null,r.output=null,r}o(n,t);var r=n.prototype;return r.copy=function(n,r){return void 0===r&&(r=_),t.prototype.copy.call(this,n,r),this.j=n.j,this.setInput(n.input?r(n.input.getChild()):null),this.setOutput(n.output?r(n.output.getChild()):null),this},r.getInterpolation=function(){return this.j},r.setInterpolation=function(t){return this.j=t,this},r.getInput=function(){return this.input?this.input.getChild():null},r.setInput=function(t){return this.input=this.graph.link("input",this,t),this},r.getOutput=function(){return this.output?this.output.getChild():null},r.setOutput=function(t){return this.output=this.graph.link("output",this,t),this},n}(U);G.Interpolation={LINEAR:"LINEAR",STEP:"STEP",CUBICSPLINE:"CUBICSPLINE"},v([w],G.prototype,"input",void 0),v([w],G.prototype,"output",void 0);var J=function(t){function n(){for(var n,r=arguments.length,i=new Array(r),e=0;e<r;e++)i[e]=arguments[e];return(n=t.call.apply(t,[this].concat(i))||this).propertyType=exports.PropertyType.BUFFER,n.C="",n}o(n,t);var r=n.prototype;return r.copy=function(n,r){return void 0===r&&(r=_),t.prototype.copy.call(this,n,r),this.C=n.C,this},r.getURI=function(){return this.C},r.setURI=function(t){return this.C=t,this},n}(B),V=function(t){function n(){for(var r,i=arguments.length,e=new Array(i),u=0;u<i;u++)e[u]=arguments[u];return(r=t.call.apply(t,[this].concat(e))||this).propertyType=exports.PropertyType.CAMERA,r.N=n.Type.PERSPECTIVE,r.k=.1,r.F=100,r.D=null,r.J=2*Math.PI*50/360,r.V=1,r.q=1,r}o(n,t);var r=n.prototype;return r.copy=function(n,r){return void 0===r&&(r=_),t.prototype.copy.call(this,n,r),this.N=n.N,this.k=n.k,this.F=n.F,this.D=n.D,this.J=n.J,this.V=n.V,this.q=n.q,this},r.getType=function(){return this.N},r.setType=function(t){return this.N=t,this},r.getZNear=function(){return this.k},r.setZNear=function(t){return this.k=t,this},r.getZFar=function(){return this.F},r.setZFar=function(t){return this.F=t,this},r.getAspectRatio=function(){return this.D},r.setAspectRatio=function(t){return this.D=t,this},r.getYFov=function(){return this.J},r.setYFov=function(t){return this.J=t,this},r.getXMag=function(){return this.V},r.setXMag=function(t){return this.V=t,this},r.getYMag=function(){return this.q},r.setYMag=function(t){return this.q=t,this},n}(B);V.Type={PERSPECTIVE:"perspective",ORTHOGRAPHIC:"orthographic"};var q=function(t){function n(n,r){var i;return(i=t.call(this,n)||this).Y=void 0,i.Y=r,i.Y.addExtensionProperty(f(i)),i}o(n,t);var r=n.prototype;return r.clone=function(){var t=new(0,this.constructor)(this.graph,this.Y).copy(this,_);return this.graph.emit("clone",t),t},r.dispose=function(){this.Y.removeExtensionProperty(this),t.prototype.dispose.call(this)},r.M=function(t){if(!this.parentTypes.includes(t.propertyType))throw new Error('Parent "'+t.propertyType+'" invalid for child "'+this.propertyType+'".')},n}(U);q.EXTENSION_NAME=void 0;var Y=function(t){function n(){for(var n,r=arguments.length,i=new Array(r),e=0;e<r;e++)i[e]=arguments[e];return(n=t.call.apply(t,[this].concat(i))||this).semantic="",n}return o(n,t),n.prototype.copy=function(t){return this.semantic=t.semantic,this},n}(l),z=function(t){function n(){return t.apply(this,arguments)||this}return o(n,t),n.prototype.copy=function(t){return this},n}(l),H=function(t){function n(){for(var n,r=arguments.length,i=new Array(r),e=0;e<r;e++)i[e]=arguments[e];return(n=t.call.apply(t,[this].concat(i))||this).channels=0,n}return o(n,t),n.prototype.copy=function(t){return this.channels=t.channels,this},n}(l),$=function(t){function n(){return t.apply(this,arguments)||this}o(n,t);var r=n.prototype;return r.linkAttribute=function(t,n,r){if(!r)return null;var i=new Y(t,n,r);return i.semantic=t,this.registerLink(i),i},r.linkIndex=function(t,n,r){if(!r)return null;var i=new z(t,n,r);return this.registerLink(i),i},r.linkTexture=function(t,n,r,i){if(!i)return null;var e=new H(t,r,i);return e.channels=n,this.registerLink(e),e},n}(d),K=function(t){function n(){for(var r,i=arguments.length,e=new Array(i),u=0;u<i;u++)e[u]=arguments[u];return(r=t.call.apply(t,[this].concat(e))||this).propertyType=exports.PropertyType.TEXTURE_INFO,r.H=0,r.$=null,r.K=null,r.W=n.WrapMode.REPEAT,r.Z=n.WrapMode.REPEAT,r}o(n,t);var r=n.prototype;return r.copy=function(n,r){return void 0===r&&(r=_),t.prototype.copy.call(this,n,r),this.H=n.H,this.$=n.$,this.K=n.K,this.W=n.W,this.Z=n.Z,this},r.getTexCoord=function(){return this.H},r.setTexCoord=function(t){return this.H=t,this},r.getMagFilter=function(){return this.$},r.setMagFilter=function(t){return this.$=t,this},r.getMinFilter=function(){return this.K},r.setMinFilter=function(t){return this.K=t,this},r.getWrapS=function(){return this.W},r.setWrapS=function(t){return this.W=t,this},r.getWrapT=function(){return this.Z},r.setWrapT=function(t){return this.Z=t,this},n}(B);K.WrapMode={CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,REPEAT:10497},K.MagFilter={NEAREST:9728,LINEAR:9729},K.MinFilter={NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987};var Q=exports.TextureChannel.R,W=exports.TextureChannel.G,Z=exports.TextureChannel.B,X=exports.TextureChannel.A,tt=function(t){function n(){for(var r,i=arguments.length,e=new Array(i),u=0;u<i;u++)e[u]=arguments[u];return(r=t.call.apply(t,[this].concat(e))||this).propertyType=exports.PropertyType.MATERIAL,r.X=n.AlphaMode.OPAQUE,r.tt=.5,r.nt=!1,r.rt=[1,1,1,1],r.it=[0,0,0],r.et=1,r.ut=1,r.st=1,r.ot=1,r.baseColorTexture=null,r.baseColorTextureInfo=r.graph.link("baseColorTextureInfo",f(r),new K(r.graph)),r.emissiveTexture=null,r.emissiveTextureInfo=r.graph.link("emissiveTextureInfo",f(r),new K(r.graph)),r.normalTexture=null,r.normalTextureInfo=r.graph.link("normalTextureInfo",f(r),new K(r.graph)),r.occlusionTexture=null,r.occlusionTextureInfo=r.graph.link("occlusionTextureInfo",f(r),new K(r.graph)),r.metallicRoughnessTexture=null,r.metallicRoughnessTextureInfo=r.graph.link("metallicRoughnessTextureInfo",f(r),new K(r.graph)),r}o(n,t);var r=n.prototype;return r.copy=function(n,r){return void 0===r&&(r=_),t.prototype.copy.call(this,n,r),this.X=n.X,this.tt=n.tt,this.nt=n.nt,this.rt=[].concat(n.rt),this.it=[].concat(n.it),this.et=n.et,this.ut=n.ut,this.st=n.st,this.ot=n.ot,this.setBaseColorTexture(n.baseColorTexture?r(n.baseColorTexture.getChild()):null),this.baseColorTextureInfo.getChild().copy(r(n.baseColorTextureInfo.getChild()),r),this.setEmissiveTexture(n.emissiveTexture?r(n.emissiveTexture.getChild()):null),this.emissiveTextureInfo.getChild().copy(r(n.emissiveTextureInfo.getChild()),r),this.setNormalTexture(n.normalTexture?r(n.normalTexture.getChild()):null),this.normalTextureInfo.getChild().copy(r(n.normalTextureInfo.getChild()),r),this.setOcclusionTexture(n.occlusionTexture?r(n.occlusionTexture.getChild()):null),this.occlusionTextureInfo.getChild().copy(r(n.occlusionTextureInfo.getChild()),r),this.setMetallicRoughnessTexture(n.metallicRoughnessTexture?r(n.metallicRoughnessTexture.getChild()):null),this.metallicRoughnessTextureInfo.getChild().copy(r(n.metallicRoughnessTextureInfo.getChild()),r),this},r.dispose=function(){this.baseColorTextureInfo.getChild().dispose(),this.emissiveTextureInfo.getChild().dispose(),this.normalTextureInfo.getChild().dispose(),this.occlusionTextureInfo.getChild().dispose(),this.metallicRoughnessTextureInfo.getChild().dispose(),t.prototype.dispose.call(this)},r.getDoubleSided=function(){return this.nt},r.setDoubleSided=function(t){return this.nt=t,this},r.getAlpha=function(){return this.rt[3]},r.setAlpha=function(t){return this.rt[3]=t,this},r.getAlphaMode=function(){return this.X},r.setAlphaMode=function(t){return this.X=t,this},r.getAlphaCutoff=function(){return this.tt},r.setAlphaCutoff=function(t){return this.tt=t,this},r.getBaseColorFactor=function(){return this.rt},r.setBaseColorFactor=function(t){return this.rt=t,this},r.getBaseColorHex=function(){return m.factorToHex(this.rt)},r.setBaseColorHex=function(t){return m.hexToFactor(t,this.rt),this},r.getBaseColorTexture=function(){return this.baseColorTexture?this.baseColorTexture.getChild():null},r.getBaseColorTextureInfo=function(){return this.baseColorTexture?this.baseColorTextureInfo.getChild():null},r.setBaseColorTexture=function(t){return this.baseColorTexture=this.graph.linkTexture("baseColorTexture",Q|W|Z|X,this,t),this},r.getEmissiveFactor=function(){return this.it},r.setEmissiveFactor=function(t){return this.it=t,this},r.getEmissiveHex=function(){return m.factorToHex(this.it)},r.setEmissiveHex=function(t){return m.hexToFactor(t,this.it),this},r.getEmissiveTexture=function(){return this.emissiveTexture?this.emissiveTexture.getChild():null},r.getEmissiveTextureInfo=function(){return this.emissiveTexture?this.emissiveTextureInfo.getChild():null},r.setEmissiveTexture=function(t){return this.emissiveTexture=this.graph.linkTexture("emissiveTexture",Q|W|Z,this,t),this},r.getNormalScale=function(){return this.et},r.setNormalScale=function(t){return this.et=t,this},r.getNormalTexture=function(){return this.normalTexture?this.normalTexture.getChild():null},r.getNormalTextureInfo=function(){return this.normalTexture?this.normalTextureInfo.getChild():null},r.setNormalTexture=function(t){return this.normalTexture=this.graph.linkTexture("normalTexture",Q|W|Z,this,t),this},r.getOcclusionStrength=function(){return this.ut},r.setOcclusionStrength=function(t){return this.ut=t,this},r.getOcclusionTexture=function(){return this.occlusionTexture?this.occlusionTexture.getChild():null},r.getOcclusionTextureInfo=function(){return this.occlusionTexture?this.occlusionTextureInfo.getChild():null},r.setOcclusionTexture=function(t){return this.occlusionTexture=this.graph.linkTexture("occlusionTexture",Q,this,t),this},r.getRoughnessFactor=function(){return this.st},r.setRoughnessFactor=function(t){return this.st=t,this},r.getMetallicFactor=function(){return this.ot},r.setMetallicFactor=function(t){return this.ot=t,this},r.getMetallicRoughnessTexture=function(){return this.metallicRoughnessTexture?this.metallicRoughnessTexture.getChild():null},r.getMetallicRoughnessTextureInfo=function(){return this.metallicRoughnessTexture?this.metallicRoughnessTextureInfo.getChild():null},r.setMetallicRoughnessTexture=function(t){return this.metallicRoughnessTexture=this.graph.linkTexture("metallicRoughnessTexture",W|Z,this,t),this},n}(B);tt.AlphaMode={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"},v([w],tt.prototype,"baseColorTexture",void 0),v([w],tt.prototype,"baseColorTextureInfo",void 0),v([w],tt.prototype,"emissiveTexture",void 0),v([w],tt.prototype,"emissiveTextureInfo",void 0),v([w],tt.prototype,"normalTexture",void 0),v([w],tt.prototype,"normalTextureInfo",void 0),v([w],tt.prototype,"occlusionTexture",void 0),v([w],tt.prototype,"occlusionTextureInfo",void 0),v([w],tt.prototype,"metallicRoughnessTexture",void 0),v([w],tt.prototype,"metallicRoughnessTextureInfo",void 0);var nt=function(t){function n(){for(var n,r=arguments.length,i=new Array(r),e=0;e<r;e++)i[e]=arguments[e];return(n=t.call.apply(t,[this].concat(i))||this).propertyType=exports.PropertyType.MESH,n.ht=[],n.primitives=[],n}o(n,t);var r=n.prototype;return r.copy=function(n,r){var i=this;return void 0===r&&(r=_),t.prototype.copy.call(this,n,r),this.ht=[].concat(n.ht),this.clearGraphChildList(this.primitives),n.primitives.forEach(function(t){return i.addPrimitive(r(t.getChild()))}),this},r.addPrimitive=function(t){return this.addGraphChild(this.primitives,this.graph.link("primitive",this,t))},r.removePrimitive=function(t){return this.removeGraphChild(this.primitives,t)},r.listPrimitives=function(){return this.primitives.map(function(t){return t.getChild()})},r.getWeights=function(){return this.ht},r.setWeights=function(t){return this.ht=t,this},n}(B);v([p],nt.prototype,"primitives",void 0);var rt=function(t){function n(){for(var n,r=arguments.length,i=new Array(r),e=0;e<r;e++)i[e]=arguments[e];return(n=t.call.apply(t,[this].concat(i))||this).propertyType=exports.PropertyType.NODE,n.ft=[0,0,0],n.ct=[0,0,0,1],n.at=[1,1,1],n.ht=[],n.i=null,n.camera=null,n.mesh=null,n.skin=null,n.children=[],n}o(n,t);var r=n.prototype;return r.copy=function(n,r){var i=this;return void 0===r&&(r=_),t.prototype.copy.call(this,n,r),this.ft=[].concat(n.ft),this.ct=[].concat(n.ct),this.at=[].concat(n.at),this.ht=[].concat(n.ht),this.setCamera(n.camera?r(n.camera.getChild()):null),this.setMesh(n.mesh?r(n.mesh.getChild()):null),this.setSkin(n.skin?r(n.skin.getChild()):null),r!==_&&(this.clearGraphChildList(this.children),n.children.forEach(function(t){return i.addChild(r(t.getChild()))})),this},r.getTranslation=function(){return this.ft},r.getRotation=function(){return this.ct},r.getScale=function(){return this.at},r.setTranslation=function(t){return this.ft=t,this},r.setRotation=function(t){return this.ct=t,this},r.setScale=function(t){return this.at=t,this},r.getMatrix=function(){return S.compose(this.ft,this.ct,this.at,[])},r.setMatrix=function(t){return S.decompose(t,this.ft,this.ct,this.at),this},r.getWorldTranslation=function(){var t=[0,0,0];return S.decompose(this.getWorldMatrix(),t,[0,0,0,1],[1,1,1]),t},r.getWorldRotation=function(){var t=[0,0,0,1];return S.decompose(this.getWorldMatrix(),[0,0,0],t,[1,1,1]),t},r.getWorldScale=function(){var t=[1,1,1];return S.decompose(this.getWorldMatrix(),[0,0,0],[0,0,0,1],t),t},r.getWorldMatrix=function(){for(var t,r=[],i=this;i instanceof n;i=i.i)r.push(i);for(var e=r.pop().getMatrix();t=r.pop();)u.multiply(e,e,t.getMatrix());return e},r.addChild=function(t){t.i&&t.i.removeChild(t);var n=this.graph.link("child",this,t);return this.addGraphChild(this.children,n),t.i=this,n.onDispose(function(){return t.i=null}),this},r.removeChild=function(t){return this.removeGraphChild(this.children,t)},r.listChildren=function(){return this.children.map(function(t){return t.getChild()})},r.getParent=function(){return this.i},r.getMesh=function(){return this.mesh?this.mesh.getChild():null},r.setMesh=function(t){return this.mesh=this.graph.link("mesh",this,t),this},r.getCamera=function(){return this.camera?this.camera.getChild():null},r.setCamera=function(t){return this.camera=this.graph.link("camera",this,t),this},r.getSkin=function(){return this.skin?this.skin.getChild():null},r.setSkin=function(t){return this.skin=this.graph.link("skin",this,t),this},r.getWeights=function(){return this.ht},r.setWeights=function(t){return this.ht=t,this},r.traverse=function(t){t(this);for(var n,r=a(this.listChildren());!(n=r()).done;)n.value.traverse(t);return this},n}(B);v([w],rt.prototype,"camera",void 0),v([w],rt.prototype,"mesh",void 0),v([w],rt.prototype,"skin",void 0),v([p],rt.prototype,"children",void 0);var it=function(t){function n(){for(var r,i=arguments.length,e=new Array(i),u=0;u<i;u++)e[u]=arguments[u];return(r=t.call.apply(t,[this].concat(e))||this).propertyType=exports.PropertyType.PRIMITIVE,r.vt=n.Mode.TRIANGLES,r.material=null,r.indices=null,r.attributes=[],r.targets=[],r}o(n,t);var r=n.prototype;return r.copy=function(n,r){var i=this;return void 0===r&&(r=_),t.prototype.copy.call(this,n,r),this.vt=n.vt,this.setIndices(n.indices?r(n.indices.getChild()):null),this.setMaterial(n.material?r(n.material.getChild()):null),this.clearGraphChildList(this.attributes),n.listSemantics().forEach(function(t){i.setAttribute(t,r(n.getAttribute(t)))}),this.clearGraphChildList(this.targets),n.targets.forEach(function(t){return i.addTarget(r(t.getChild()))}),this},r.getIndices=function(){return this.indices?this.indices.getChild():null},r.setIndices=function(t){return this.indices=this.graph.linkIndex("indices",this,t),this},r.getAttribute=function(t){var n=this.attributes.find(function(n){return n.semantic===t});return n?n.getChild():null},r.setAttribute=function(t,n){var r=this.getAttribute(t);if(r&&this.removeGraphChild(this.attributes,r),!n)return this;var i=this.graph.linkAttribute(t,this,n);return this.addGraphChild(this.attributes,i)},r.listAttributes=function(){return this.attributes.map(function(t){return t.getChild()})},r.listSemantics=function(){return this.attributes.map(function(t){return t.semantic})},r.getMaterial=function(){return this.material?this.material.getChild():null},r.setMaterial=function(t){return this.material=this.graph.link("material",this,t),this},r.getMode=function(){return this.vt},r.setMode=function(t){return this.vt=t,this},r.listTargets=function(){return this.targets.map(function(t){return t.getChild()})},r.addTarget=function(t){return this.addGraphChild(this.targets,this.graph.link("target",this,t)),this},r.removeTarget=function(t){return this.removeGraphChild(this.targets,t)},n}(B);it.Mode={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},v([w],it.prototype,"material",void 0),v([w],it.prototype,"indices",void 0),v([p],it.prototype,"attributes",void 0),v([p],it.prototype,"targets",void 0);var et=function(t){function n(){for(var n,r=arguments.length,i=new Array(r),e=0;e<r;e++)i[e]=arguments[e];return(n=t.call.apply(t,[this].concat(i))||this).propertyType=exports.PropertyType.PRIMITIVE_TARGET,n.attributes=[],n}o(n,t);var r=n.prototype;return r.copy=function(n,r){var i=this;return void 0===r&&(r=_),t.prototype.copy.call(this,n,r),this.clearGraphChildList(this.attributes),n.listSemantics().forEach(function(t){i.setAttribute(t,r(n.getAttribute(t)))}),this},r.getAttribute=function(t){var n=this.attributes.find(function(n){return n.semantic===t});return n?n.getChild():null},r.setAttribute=function(t,n){var r=this.getAttribute(t);if(r&&this.removeGraphChild(this.attributes,r),!n)return this;var i=this.graph.linkAttribute(t,this,n);return i.semantic=t,this.addGraphChild(this.attributes,i)},r.listAttributes=function(){return this.attributes.map(function(t){return t.getChild()})},r.listSemantics=function(){return this.attributes.map(function(t){return t.semantic})},n}(U);v([p],et.prototype,"attributes",void 0);var ut=function(t){function n(){for(var n,r=arguments.length,i=new Array(r),e=0;e<r;e++)i[e]=arguments[e];return(n=t.call.apply(t,[this].concat(i))||this).propertyType=exports.PropertyType.SCENE,n.children=[],n}o(n,t);var r=n.prototype;return r.copy=function(n,r){var i=this;return void 0===r&&(r=_),t.prototype.copy.call(this,n,r),r!==_&&(this.clearGraphChildList(this.children),n.children.forEach(function(t){return i.addChild(r(t.getChild()))})),this},r.addChild=function(t){t.i&&t.i.removeChild(t);var n=this.graph.link("child",this,t);return this.addGraphChild(this.children,n),t.i=this,n.onDispose(function(){return t.i=null}),this},r.removeChild=function(t){return this.removeGraphChild(this.children,t)},r.listChildren=function(){return this.children.map(function(t){return t.getChild()})},r.traverse=function(t){for(var n,r=a(this.listChildren());!(n=r()).done;)n.value.traverse(t);return this},n}(B);v([p],ut.prototype,"children",void 0);var st=function(t){function n(){for(var n,r=arguments.length,i=new Array(r),e=0;e<r;e++)i[e]=arguments[e];return(n=t.call.apply(t,[this].concat(i))||this).propertyType=exports.PropertyType.SKIN,n.skeleton=null,n.inverseBindMatrices=null,n.joints=[],n}o(n,t);var r=n.prototype;return r.copy=function(n,r){var i=this;return void 0===r&&(r=_),t.prototype.copy.call(this,n,r),this.setSkeleton(n.skeleton?r(n.skeleton.getChild()):null),this.setInverseBindMatrices(n.inverseBindMatrices?r(n.inverseBindMatrices.getChild()):null),this.clearGraphChildList(this.joints),n.joints.forEach(function(t){return i.addJoint(r(t.getChild()))}),this},r.getSkeleton=function(){return this.skeleton?this.skeleton.getChild():null},r.setSkeleton=function(t){return this.skeleton=this.graph.link("skeleton",this,t),this},r.getInverseBindMatrices=function(){return this.inverseBindMatrices?this.inverseBindMatrices.getChild():null},r.setInverseBindMatrices=function(t){return this.inverseBindMatrices=this.graph.link("inverseBindMatrices",this,t),this},r.addJoint=function(t){var n=this.graph.link("joint",this,t);return this.addGraphChild(this.joints,n)},r.removeJoint=function(t){return this.removeGraphChild(this.joints,t)},r.listJoints=function(){return this.joints.map(function(t){return t.getChild()})},n}(B);v([w],st.prototype,"skeleton",void 0),v([w],st.prototype,"inverseBindMatrices",void 0),v([p],st.prototype,"joints",void 0);var ot=function(t){function n(){for(var n,r=arguments.length,i=new Array(r),e=0;e<r;e++)i[e]=arguments[e];return(n=t.call.apply(t,[this].concat(i))||this).propertyType=exports.PropertyType.TEXTURE,n.lt=null,n.dt="",n.C="",n}o(n,t);var r=n.prototype;return r.copy=function(n,r){return void 0===r&&(r=_),t.prototype.copy.call(this,n,r),this.dt=n.dt,this.C=n.C,n.lt&&(this.lt=n.lt.slice(0)),this},r.getMimeType=function(){return this.dt||g.extensionToMimeType(b.extension(this.C))},r.setMimeType=function(t){return this.dt=t,this},r.getURI=function(){return this.C},r.setURI=function(t){return this.C=t,this.dt=g.extensionToMimeType(b.extension(t)),this},r.getImage=function(){return this.lt},r.setImage=function(t){return this.lt=t,this},r.getSize=function(){return this.lt?g.getSize(this.lt,this.getMimeType()):null},n}(B),ht=function(t){function n(n){var r;return(r=t.call(this,n)||this).propertyType=exports.PropertyType.ROOT,r.wt={generator:"glTF-Transform v0.12.16",version:"2.0"},r.xt=new Set,r.defaultScene=null,r.accessors=[],r.animations=[],r.buffers=[],r.cameras=[],r.materials=[],r.meshes=[],r.nodes=[],r.scenes=[],r.skins=[],r.textures=[],n.on("clone",function(t){return r.yt(t)}),r}o(n,t);var r=n.prototype;return r.clone=function(){throw new Error("Root cannot be cloned.")},r.copy=function(n,r){var i=this;if(void 0===r&&(r=_),t.prototype.copy.call(this,n,r),r===_)throw new Error("Root cannot be copied.");return Object.assign(this.wt,n.wt),n.accessors.forEach(function(t){return i.At(r(t.getChild()))}),n.animations.forEach(function(t){return i.Et(r(t.getChild()))}),n.buffers.forEach(function(t){return i.bt(r(t.getChild()))}),n.cameras.forEach(function(t){return i.Tt(r(t.getChild()))}),n.materials.forEach(function(t){return i.It(r(t.getChild()))}),n.meshes.forEach(function(t){return i.gt(r(t.getChild()))}),n.nodes.forEach(function(t){return i.Mt(r(t.getChild()))}),n.scenes.forEach(function(t){return i.St(r(t.getChild()))}),n.skins.forEach(function(t){return i.Rt(r(t.getChild()))}),n.textures.forEach(function(t){return i.Nt(r(t.getChild()))}),this.setDefaultScene(n.defaultScene?r(n.defaultScene.getChild()):null),this},r.yt=function(t){return t instanceof ut?this.St(t):t instanceof rt?this.Mt(t):t instanceof V?this.Tt(t):t instanceof st?this.Rt(t):t instanceof nt?this.gt(t):t instanceof tt?this.It(t):t instanceof ot?this.Nt(t):t instanceof F?this.Et(t):t instanceof C?this.At(t):t instanceof J&&this.bt(t),this},r.getAsset=function(){return this.wt},r.listExtensionsUsed=function(){return Array.from(this.xt)},r.listExtensionsRequired=function(){return this.listExtensionsUsed().filter(function(t){return t.isRequired()})},r.Ot=function(t){return this.xt.add(t),this},r.Lt=function(t){return this.xt.delete(t),this},r.St=function(t){return this.addGraphChild(this.scenes,this.graph.link("scene",this,t))},r.listScenes=function(){return this.scenes.map(function(t){return t.getChild()})},r.setDefaultScene=function(t){return this.defaultScene=this.graph.link("scene",this,t),this},r.getDefaultScene=function(){return this.defaultScene?this.defaultScene.getChild():null},r.Mt=function(t){return this.addGraphChild(this.nodes,this.graph.link("node",this,t))},r.listNodes=function(){return this.nodes.map(function(t){return t.getChild()})},r.Tt=function(t){return this.addGraphChild(this.cameras,this.graph.link("camera",this,t))},r.listCameras=function(){return this.cameras.map(function(t){return t.getChild()})},r.Rt=function(t){return this.addGraphChild(this.skins,this.graph.link("skin",this,t))},r.listSkins=function(){return this.skins.map(function(t){return t.getChild()})},r.gt=function(t){return this.addGraphChild(this.meshes,this.graph.link("mesh",this,t))},r.listMeshes=function(){return this.meshes.map(function(t){return t.getChild()})},r.It=function(t){return this.addGraphChild(this.materials,this.graph.link("material",this,t))},r.listMaterials=function(){return this.materials.map(function(t){return t.getChild()})},r.Nt=function(t){return this.addGraphChild(this.textures,this.graph.link("texture",this,t))},r.listTextures=function(){return this.textures.map(function(t){return t.getChild()})},r.Et=function(t){return this.addGraphChild(this.animations,this.graph.link("animation",this,t))},r.listAnimations=function(){return this.animations.map(function(t){return t.getChild()})},r.At=function(t){return this.addGraphChild(this.accessors,this.graph.link("accessor",this,t))},r.listAccessors=function(){return this.accessors.map(function(t){return t.getChild()})},r.bt=function(t){return this.addGraphChild(this.buffers,this.graph.link("buffer",this,t))},r.listBuffers=function(){return this.buffers.map(function(t){return t.getChild()})},n}(U);v([w],ht.prototype,"defaultScene",void 0),v([p],ht.prototype,"accessors",void 0),v([p],ht.prototype,"animations",void 0),v([p],ht.prototype,"buffers",void 0),v([p],ht.prototype,"cameras",void 0),v([p],ht.prototype,"materials",void 0),v([p],ht.prototype,"meshes",void 0),v([p],ht.prototype,"nodes",void 0),v([p],ht.prototype,"scenes",void 0),v([p],ht.prototype,"skins",void 0),v([p],ht.prototype,"textures",void 0);var ft="undefined"!=typeof Symbol?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function ct(t,n,r){if(!t.s){if(r instanceof at){if(!r.s)return void(r.o=ct.bind(null,t,n));1&n&&(n=r.s),r=r.v}if(r&&r.then)return void r.then(ct.bind(null,t,n),ct.bind(null,t,2));t.s=n,t.v=r;var i=t.o;i&&i(t)}}var at=function(){function t(){}return t.prototype.then=function(n,r){var i=new t,e=this.s;if(e){var u=1&e?n:r;if(u){try{ct(i,1,u(this.v))}catch(t){ct(i,2,t)}return i}return this}return this.o=function(t){try{var e=t.v;1&t.s?ct(i,1,n?n(e):e):r?ct(i,1,r(e)):ct(i,2,e)}catch(t){ct(i,2,t)}},i},t}();function vt(t){return t instanceof at&&1&t.s}function lt(t,n,r){if("function"==typeof t[ft]){var i,e,u,s=t[ft]();if(function t(o){try{for(;!((i=s.next()).done||r&&r());)if((o=n(i.value))&&o.then){if(!vt(o))return void o.then(t,u||(u=ct.bind(null,e=new at,2)));o=o.v}e?ct(e,1,o):e=o}catch(t){ct(e||(e=new at),2,t)}}(),s.return){var o=function(t){try{i.done||s.return()}catch(t){}return t};if(e&&e.then)return e.then(o,function(t){throw o(t)});o()}return e}if(!("length"in t))throw new TypeError("Object is not iterable");for(var h=[],f=0;f<t.length;f++)h.push(t[f]);return function(t,n,r){var i,e,u=-1;return function s(o){try{for(;++u<t.length&&(!r||!r());)if((o=n(u))&&o.then){if(!vt(o))return void o.then(s,e||(e=ct.bind(null,i=new at,2)));o=o.v}i?ct(i,1,o):i=o}catch(t){ct(i||(i=new at),2,t)}}(),i}(h,function(t){return n(h[t])},r)}var dt=function(){function t(){this.Pt=new $,this._t=new ht(this.Pt),this.Ut=R.DEFAULT_INSTANCE}var n=t.prototype;return n.getRoot=function(){return this._t},n.getGraph=function(){return this.Pt},n.getLogger=function(){return this.Ut},n.setLogger=function(t){return this.Ut=t,this},n.clone=function(){return(new t).merge(this).setLogger(this.Ut)},n.merge=function(t){for(var n,r={},i=a(t.getRoot().listExtensionsUsed());!(n=i()).done;){var e=n.value,u=this.createExtension(e.constructor);e.isRequired()&&u.setRequired(!0),r[u.extensionName]=u}var s=new Set,o=new Map;s.add(t._t),o.set(t._t,this._t);for(var h,f=a(t.Pt.getLinks());!(h=f()).done;)for(var c=h.value,v=0,l=[c.getParent(),c.getChild()];v<l.length;v++){var d=l[v];if(!s.has(d)){var w=void 0;if(d.propertyType===exports.PropertyType.TEXTURE_INFO)w=d;else{var p=d.constructor;w=d instanceof q?new p(this.Pt,r[d.extensionName]):new p(this.Pt)}o.set(d,w),s.add(d)}}for(var x,y=function(t){var n=o.get(t);if(!n)throw new Error("Could resolve property.");return n},A=a(s);!(x=A()).done;){var E=x.value,m=o.get(E);if(!m)throw new Error("Could resolve property.");m.copy(E,y)}return this},n.transform=function(){try{var t=arguments,n=this,r=lt([].slice.call(t),function(t){return Promise.resolve(t(n)).then(function(){})});return Promise.resolve(r&&r.then?r.then(function(){return n}):n)}catch(t){return Promise.reject(t)}},n.createExtension=function(t){var n=t.EXTENSION_NAME;return this.getRoot().listExtensionsUsed().find(function(t){return t.extensionName===n})||new t(this)},n.createScene=function(t){void 0===t&&(t="");var n=new ut(this.Pt,t);return this._t.St(n),n},n.createNode=function(t){void 0===t&&(t="");var n=new rt(this.Pt,t);return this._t.Mt(n),n},n.createCamera=function(t){void 0===t&&(t="");var n=new V(this.Pt,t);return this._t.Tt(n),n},n.createSkin=function(t){void 0===t&&(t="");var n=new st(this.Pt,t);return this._t.Rt(n),n},n.createMesh=function(t){void 0===t&&(t="");var n=new nt(this.Pt,t);return this._t.gt(n),n},n.createPrimitive=function(){return new it(this.Pt)},n.createPrimitiveTarget=function(t){return void 0===t&&(t=""),new et(this.Pt,t)},n.createMaterial=function(t){void 0===t&&(t="");var n=new tt(this.Pt,t);return this._t.It(n),n},n.createTexture=function(t){void 0===t&&(t="");var n=new ot(this.Pt,t);return this._t.Nt(n),n},n.createAnimation=function(t){void 0===t&&(t="");var n=new F(this.Pt,t);return this._t.Et(n),n},n.createAnimationChannel=function(t){return void 0===t&&(t=""),new D(this.Pt,t)},n.createAnimationSampler=function(t){return void 0===t&&(t=""),new G(this.Pt,t)},n.createAccessor=function(t,n){void 0===t&&(t=""),void 0===n&&(n=null),n||(n=this.getRoot().listBuffers()[0]);var r=new C(this.Pt,t).setBuffer(n);return this._t.At(r),r},n.createBuffer=function(t){void 0===t&&(t="");var n=new J(this.Pt,t);return this._t.bt(n),n},t}(),wt=function(){function t(t){this.doc=void 0,this.extensionName="",this.prereadTypes=[],this.prewriteTypes=[],this.readDependencies=[],this.writeDependencies=[],this.required=!1,this.properties=new Set,this.doc=t,t.getRoot().Ot(this)}var n=t.prototype;return n.dispose=function(){this.doc.getRoot().Lt(this);for(var t,n=a(this.properties);!(t=n()).done;)t.value.dispose()},t.register=function(){},n.isRequired=function(){return this.required},n.setRequired=function(t){return this.required=t,this},n.addExtensionProperty=function(t){return this.properties.add(t),this},n.removeExtensionProperty=function(t){return this.properties.delete(t),this},n.install=function(t,n){return this},n.preread=function(t,n){return this},n.prewrite=function(t,n){return this},t}();wt.EXTENSION_NAME=void 0;var pt,xt,yt,At=function(){function t(t){this.jsonDoc=void 0,this.buffers=[],this.bufferViews=[],this.bufferViewBuffers=[],this.accessors=[],this.textures=[],this.textureInfos=new Map,this.materials=[],this.meshes=[],this.cameras=[],this.nodes=[],this.skins=[],this.animations=[],this.scenes=[],this.jsonDoc=t}return t.prototype.setTextureInfo=function(t,n){this.textureInfos.set(t,n),void 0!==n.texCoord&&t.setTexCoord(n.texCoord);var r=this.jsonDoc.json.textures[n.index];if(void 0!==r.sampler){var i=this.jsonDoc.json.samplers[r.sampler];void 0!==i.magFilter&&t.setMagFilter(i.magFilter),void 0!==i.minFilter&&t.setMinFilter(i.minFilter),void 0!==i.wrapS&&t.setWrapS(i.wrapS),void 0!==i.wrapT&&t.setWrapT(i.wrapT)}},t}(),Et={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},mt={logger:R.DEFAULT_INSTANCE,extensions:[],dependencies:{}},bt=function(){function t(){}return t.read=function(t,n){void 0===n&&(n=mt);var r=s({},mt,n),i=t.json,e=new dt;this.validate(t,r);var u=new At(t),o=i.asset,h=e.getRoot().getAsset();o.copyright&&(h.copyright=o.copyright),o.extras&&(h.extras=o.extras),o.generator&&(h.generator=o.generator),o.minVersion&&(h.minVersion=o.minVersion),void 0!==i.extras&&e.getRoot().setExtras(s({},i.extras));for(var f,c=i.extensionsUsed||[],v=i.extensionsRequired||[],l=a(r.extensions);!(f=l()).done;){var d=f.value;if(c.includes(d.EXTENSION_NAME))for(var w,p=e.createExtension(d).setRequired(v.includes(d.EXTENSION_NAME)),x=a(p.readDependencies);!(w=x()).done;){var y=w.value;p.install(y,r.dependencies[y])}}var A=i.buffers||[];e.getRoot().listExtensionsUsed().filter(function(t){return t.prereadTypes.includes(exports.PropertyType.BUFFER)}).forEach(function(t){return t.preread(u,exports.PropertyType.BUFFER)}),u.buffers=A.map(function(t){var n=e.createBuffer(t.name);return t.extras&&n.setExtras(t.extras),t.uri&&0!==t.uri.indexOf("__")&&n.setURI(t.uri),n}),u.bufferViewBuffers=(i.bufferViews||[]).map(function(n,r){if(!u.bufferViews[r]){var i=t.json.buffers[n.buffer],e=new Uint8Array(i.uri?t.resources[i.uri]:t.resources["@glb.bin"],n.byteOffset||0,n.byteLength);u.bufferViews[r]=e}return u.buffers[n.buffer]}),u.accessors=(i.accessors||[]).map(function(t){var n,r=e.createAccessor(t.name,u.bufferViewBuffers[t.bufferView]).setType(t.type);return t.extras&&r.setExtras(t.extras),void 0!==t.normalized&&r.setNormalized(t.normalized),void 0!==t.bufferView||t.sparse?(n=void 0!==t.sparse?function(t,n){var r,i=Et[t.componentType],e=C.getElementSize(t.type);r=void 0!==t.bufferView?Tt(t,n):new i(t.count*e);for(var u=t.sparse,o=u.count,h=s({},t,u.indices,{count:o,type:"SCALAR"}),f=s({},t,u.values,{count:o}),c=Tt(h,n),a=Tt(f,n),v=0;v<h.count;v++)for(var l=0;l<e;l++)r[c[v]*e+l]=a[v*e+l];return r}(t,u):Tt(t,u),r.setArray(n),r):r});var E=i.images||[],m=i.textures||[];e.getRoot().listExtensionsUsed().filter(function(t){return t.prereadTypes.includes(exports.PropertyType.TEXTURE)}).forEach(function(t){return t.preread(u,exports.PropertyType.TEXTURE)}),u.textures=E.map(function(n){var r=e.createTexture(n.name);if(n.extras&&r.setExtras(n.extras),void 0!==n.bufferView){var u=i.bufferViews[n.bufferView],s=t.json.buffers[u.buffer],o=u.byteOffset||0,h=(s.uri?t.resources[s.uri]:t.resources["@glb.bin"]).slice(o,o+u.byteLength);r.setImage(h)}else void 0!==n.uri&&(r.setImage(t.resources[n.uri]),0!==n.uri.indexOf("__")&&r.setURI(n.uri));if(void 0!==n.mimeType)r.setMimeType(n.mimeType);else if(n.uri){var f=b.extension(n.uri);r.setMimeType(g.extensionToMimeType(f))}return r}),u.materials=(i.materials||[]).map(function(t){var n=e.createMaterial(t.name);t.extras&&n.setExtras(t.extras),void 0!==t.alphaMode&&n.setAlphaMode(t.alphaMode),void 0!==t.alphaCutoff&&n.setAlphaCutoff(t.alphaCutoff),void 0!==t.doubleSided&&n.setDoubleSided(t.doubleSided);var r=t.pbrMetallicRoughness||{};if(void 0!==r.baseColorFactor&&n.setBaseColorFactor(r.baseColorFactor),void 0!==t.emissiveFactor&&n.setEmissiveFactor(t.emissiveFactor),void 0!==r.metallicFactor&&n.setMetallicFactor(r.metallicFactor),void 0!==r.roughnessFactor&&n.setRoughnessFactor(r.roughnessFactor),void 0!==r.baseColorTexture){var i=r.baseColorTexture;n.setBaseColorTexture(u.textures[m[i.index].source]),u.setTextureInfo(n.getBaseColorTextureInfo(),i)}if(void 0!==t.emissiveTexture){var s=t.emissiveTexture;n.setEmissiveTexture(u.textures[m[s.index].source]),u.setTextureInfo(n.getEmissiveTextureInfo(),s)}if(void 0!==t.normalTexture){var o=t.normalTexture;n.setNormalTexture(u.textures[m[o.index].source]),u.setTextureInfo(n.getNormalTextureInfo(),o),void 0!==t.normalTexture.scale&&n.setNormalScale(t.normalTexture.scale)}if(void 0!==t.occlusionTexture){var h=t.occlusionTexture;n.setOcclusionTexture(u.textures[m[h.index].source]),u.setTextureInfo(n.getOcclusionTextureInfo(),h),void 0!==t.occlusionTexture.strength&&n.setOcclusionStrength(t.occlusionTexture.strength)}if(void 0!==r.metallicRoughnessTexture){var f=r.metallicRoughnessTexture;n.setMetallicRoughnessTexture(u.textures[m[f.index].source]),u.setTextureInfo(n.getMetallicRoughnessTextureInfo(),f)}return n});var T=i.meshes||[];e.getRoot().listExtensionsUsed().filter(function(t){return t.prereadTypes.includes(exports.PropertyType.PRIMITIVE)}).forEach(function(t){return t.preread(u,exports.PropertyType.PRIMITIVE)}),u.meshes=T.map(function(t){var n=e.createMesh(t.name);return t.extras&&n.setExtras(t.extras),void 0!==t.weights&&n.setWeights(t.weights),(t.primitives||[]).forEach(function(r){var i=e.createPrimitive();r.extras&&i.setExtras(r.extras),void 0!==r.material&&i.setMaterial(u.materials[r.material]),void 0!==r.mode&&i.setMode(r.mode);for(var s=0,o=Object.entries(r.attributes||{});s<o.length;s++){var h=o[s];i.setAttribute(h[0],u.accessors[h[1]])}void 0!==r.indices&&i.setIndices(u.accessors[r.indices]);var f=t.extras&&t.extras.targetNames||[];(r.targets||[]).forEach(function(t,n){for(var r=f[n]||n.toString(),s=e.createPrimitiveTarget(r),o=0,h=Object.entries(t);o<h.length;o++){var c=h[o];s.setAttribute(c[0],u.accessors[c[1]])}i.addTarget(s)}),n.addPrimitive(i)}),n}),u.cameras=(i.cameras||[]).map(function(t){var n=e.createCamera(t.name).setType(t.type);if(t.extras&&n.setExtras(t.extras),t.type===V.Type.PERSPECTIVE){var r=t.perspective;n.setYFov(r.yfov),n.setZNear(r.znear),void 0!==r.zfar&&n.setZFar(r.zfar),void 0!==r.aspectRatio&&n.setAspectRatio(r.aspectRatio)}else{var i=t.orthographic;n.setZNear(i.znear).setZFar(i.zfar).setXMag(i.xmag).setYMag(i.ymag)}return n});var I=i.nodes||[];e.getRoot().listExtensionsUsed().filter(function(t){return t.prereadTypes.includes(exports.PropertyType.NODE)}).forEach(function(t){return t.preread(u,exports.PropertyType.NODE)}),u.nodes=I.map(function(t){var n=e.createNode(t.name);if(t.extras&&n.setExtras(t.extras),void 0!==t.translation&&n.setTranslation(t.translation),void 0!==t.rotation&&n.setRotation(t.rotation),void 0!==t.scale&&n.setScale(t.scale),void 0!==t.matrix){var r=[0,0,0],i=[0,0,0,1],u=[1,1,1];S.decompose(t.matrix,r,i,u),n.setTranslation(r),n.setRotation(i),n.setScale(u)}return void 0!==t.weights&&n.setWeights(t.weights),n}),u.skins=(i.skins||[]).map(function(t){var n=e.createSkin(t.name);t.extras&&n.setExtras(t.extras),void 0!==t.inverseBindMatrices&&n.setInverseBindMatrices(u.accessors[t.inverseBindMatrices]),void 0!==t.skeleton&&n.setSkeleton(u.nodes[t.skeleton]);for(var r,i=a(t.joints);!(r=i()).done;)n.addJoint(u.nodes[r.value]);return n}),I.map(function(t,n){var r=u.nodes[n];(t.children||[]).forEach(function(t){return r.addChild(u.nodes[t])}),void 0!==t.mesh&&r.setMesh(u.meshes[t.mesh]),void 0!==t.camera&&r.setCamera(u.cameras[t.camera]),void 0!==t.skin&&r.setSkin(u.skins[t.skin])}),u.animations=(i.animations||[]).map(function(t){var n=e.createAnimation(t.name);t.extras&&n.setExtras(t.extras);var r=(t.samplers||[]).map(function(t){var r=e.createAnimationSampler().setInput(u.accessors[t.input]).setOutput(u.accessors[t.output]).setInterpolation(t.interpolation||G.Interpolation.LINEAR);return t.extras&&r.setExtras(t.extras),n.addSampler(r),r});return(t.channels||[]).forEach(function(t){var i=e.createAnimationChannel().setSampler(r[t.sampler]).setTargetNode(u.nodes[t.target.node]).setTargetPath(t.target.path);t.extras&&i.setExtras(t.extras),n.addChannel(i)}),n});var M=i.scenes||[];return e.getRoot().listExtensionsUsed().filter(function(t){return t.prereadTypes.includes(exports.PropertyType.SCENE)}).forEach(function(t){return t.preread(u,exports.PropertyType.SCENE)}),u.scenes=M.map(function(t){var n=e.createScene(t.name);return t.extras&&n.setExtras(t.extras),(t.nodes||[]).map(function(t){return u.nodes[t]}).forEach(function(t){return n.addChild(t)}),n}),void 0!==i.scene&&e.getRoot().setDefaultScene(u.scenes[i.scene]),e.getRoot().listExtensionsUsed().forEach(function(t){return t.read(u)}),e},t.validate=function(t,n){var r=t.json;if("2.0"!==r.asset.version)throw new Error('Unsupported glTF version, "'+r.asset.version+'".');if(r.extensionsRequired)for(var i,e=function(){var t=i.value;if(!n.extensions.find(function(n){return n.EXTENSION_NAME===t}))throw new Error('Missing required extension, "'+t+'".')},u=a(r.extensionsRequired);!(i=u()).done;)e();if(r.extensionsUsed)for(var s,o=function(){var t=s.value;n.extensions.find(function(n){return n.EXTENSION_NAME===t})||n.logger.warn('Missing optional extension, "'+t+'".')},h=a(r.extensionsUsed);!(s=h()).done;)o()},t}();function Tt(t,n){var r=n.bufferViews[t.bufferView],i=n.jsonDoc.json.bufferViews[t.bufferView],e=Et[t.componentType],u=C.getElementSize(t.type),s=e.BYTES_PER_ELEMENT;if(void 0!==i.byteStride&&i.byteStride!==u*s)return function(t,n){for(var r=n.bufferViews[t.bufferView],i=n.jsonDoc.json.bufferViews[t.bufferView],e=Et[t.componentType],u=C.getElementSize(t.type),s=e.BYTES_PER_ELEMENT,o=t.byteOffset||0,h=new e(t.count*u),f=new DataView(r.buffer,r.byteOffset,r.byteLength),c=i.byteStride,a=0;a<t.count;a++)for(var v=0;v<u;v++){var l=o+a*c+v*s,d=void 0;switch(t.componentType){case C.ComponentType.FLOAT:d=f.getFloat32(l,!0);break;case C.ComponentType.UNSIGNED_INT:d=f.getUint32(l,!0);break;case C.ComponentType.UNSIGNED_SHORT:d=f.getUint16(l,!0);break;case C.ComponentType.UNSIGNED_BYTE:d=f.getUint8(l);break;case C.ComponentType.SHORT:d=f.getInt16(l,!0);break;case C.ComponentType.BYTE:d=f.getInt8(l);break;default:throw new Error('Unexpected componentType "'+t.componentType+'".')}h[a*u+v]=d}return h}(t,n);var o=r.byteOffset+(t.byteOffset||0);return new e(r.buffer.slice(o,o+t.count*u*s))}!function(t){t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER"}(xt||(xt={})),function(t){t.ARRAY_BUFFER="ARRAY_BUFFER",t.ELEMENT_ARRAY_BUFFER="ELEMENT_ARRAY_BUFFER",t.INVERSE_BIND_MATRICES="INVERSE_BIND_MATRICES",t.OTHER="OTHER"}(yt||(yt={}));var It=function(){function t(t,n,r){this.jt=void 0,this.jsonDoc=void 0,this.options=void 0,this.accessorIndexMap=new Map,this.bufferIndexMap=new Map,this.cameraIndexMap=new Map,this.skinIndexMap=new Map,this.materialIndexMap=new Map,this.meshIndexMap=new Map,this.nodeIndexMap=new Map,this.imageIndexMap=new Map,this.textureDefIndexMap=new Map,this.textureInfoDefMap=new Map,this.samplerDefIndexMap=new Map,this.imageBufferViews=[],this.otherBufferViews=new Map,this.otherBufferViewsIndexMap=new Map,this.extensionData={},this.bufferURIGenerator=void 0,this.imageURIGenerator=void 0,this.logger=void 0,this.Bt=new Map,this.accessorUsageGroupedByParent=new Set(["ARRAY_BUFFER"]),this.accessorParents=new Map,this.jt=t,this.jsonDoc=n,this.options=r;var i=t.getRoot(),e=i.listBuffers().length,u=i.listTextures().length;this.bufferURIGenerator=new Mt(e>1,r.basename),this.imageURIGenerator=new Mt(u>1,r.basename),this.logger=t.getLogger()}var n=t.prototype;return n.createTextureInfoDef=function(t,n){var r={magFilter:n.getMagFilter()||void 0,minFilter:n.getMinFilter()||void 0,wrapS:n.getWrapS(),wrapT:n.getWrapT()},i=JSON.stringify(r);this.samplerDefIndexMap.has(i)||(this.samplerDefIndexMap.set(i,this.jsonDoc.json.samplers.length),this.jsonDoc.json.samplers.push(r));var e={source:this.imageIndexMap.get(t),sampler:this.samplerDefIndexMap.get(i)},u=JSON.stringify(e);this.textureDefIndexMap.has(u)||(this.textureDefIndexMap.set(u,this.jsonDoc.json.textures.length),this.jsonDoc.json.textures.push(e));var s={index:this.textureDefIndexMap.get(u)};return 0!==n.getTexCoord()&&(s.texCoord=n.getTexCoord()),this.textureInfoDefMap.set(n,s),s},n.createPropertyDef=function(t){var n={};return t.getName()&&(n.name=t.getName()),Object.keys(t.getExtras()).length>0&&(n.extras=t.getExtras()),n},n.createAccessorDef=function(t){var n=this.createPropertyDef(t);return n.type=t.getType(),n.componentType=t.getComponentType(),n.count=t.getCount(),this.jt.getGraph().listParentLinks(t).some(function(t){return"POSITION"===t.getName()||"input"===t.getName()})&&(n.max=t.getMax([]).map(Math.fround),n.min=t.getMin([]).map(Math.fround)),t.getNormalized()&&(n.normalized=t.getNormalized()),n},n.createImageData=function(t,n,r){if(this.options.format===exports.Format.GLB)this.imageBufferViews.push(n),t.bufferView=this.jsonDoc.json.bufferViews.length,this.jsonDoc.json.bufferViews.push({buffer:0,byteOffset:-1,byteLength:n.byteLength});else{var i=g.mimeTypeToExtension(r.getMimeType());t.uri=this.imageURIGenerator.createURI(r,i),this.jsonDoc.resources[t.uri]=n}},n.getAccessorUsage=function(n){var r=this.Bt.get(n);if(r)return r;for(var i,e=a(this.jt.getGraph().listParentLinks(n));!(i=e()).done;){var u=i.value;if("inverseBindMatrices"===u.getName())return t.BufferViewUsage.INVERSE_BIND_MATRICES;if(u instanceof Y)return t.BufferViewUsage.ARRAY_BUFFER;if(u instanceof z)return t.BufferViewUsage.ELEMENT_ARRAY_BUFFER}return t.BufferViewUsage.OTHER},n.addAccessorToUsageGroup=function(t,n){var r=this.Bt.get(t);if(r&&r!==n)throw new Error('Accessor with usage "'+r+'" cannot be reused as "'+n+'".');return this.Bt.set(t,n),this},n.listAccessorUsageGroups=function(){for(var t={},n=0,r=Array.from(this.Bt.entries());n<r.length;n++){var i=r[n],e=i[0],u=i[1];t[u]=t[u]||[],t[u].push(e)}return t},t}();It.BufferViewTarget=xt,It.BufferViewUsage=yt,It.USAGE_TO_TARGET=((pt={})[yt.ARRAY_BUFFER]=xt.ARRAY_BUFFER,pt[yt.ELEMENT_ARRAY_BUFFER]=xt.ELEMENT_ARRAY_BUFFER,pt);var gt,Mt=function(){function t(t,n){this.multiple=void 0,this.basename=void 0,this.counter=1,this.multiple=t,this.basename=n}return t.prototype.createURI=function(t,n){return t.getURI()?t.getURI():this.multiple?this.basename+"_"+this.counter+++"."+n:this.basename+"."+n},t}(),St=It.BufferViewUsage,Rt=function(){function t(){}return t.write=function(t,n){for(var r,i=t.getRoot(),e={asset:s({},i.getAsset(),{generator:"glTF-Transform v0.12.16"}),extras:s({},i.getExtras())},u={json:e,resources:{}},o=new It(t,u,n),h=n.logger||R.DEFAULT_INSTANCE,f=a(t.getRoot().listExtensionsUsed());!(r=f()).done;)for(var c,v=r.value,l=a(v.writeDependencies);!(c=l()).done;){var d=c.value;v.install(d,n.dependencies[d])}function w(t,n,r,i){for(var u,s=[],h=0,f=a(t);!(u=f()).done;){var c=u.value,v=o.createAccessorDef(c);v.bufferView=e.bufferViews.length;var l=E.pad(c.getArray().buffer);v.byteOffset=h,h+=l.byteLength,s.push(l),o.accessorIndexMap.set(c,e.accessors.length),e.accessors.push(v)}var d={buffer:n,byteOffset:r,byteLength:E.concat(s).byteLength};return i&&(d.target=i),e.bufferViews.push(d),{buffers:s,byteLength:h}}function p(t,n,r){for(var i,u=t[0].getCount(),s=0,h=a(t);!(i=h()).done;){var f=i.value,c=o.createAccessorDef(f);c.bufferView=e.bufferViews.length,c.byteOffset=s;var v=f.getElementSize(),l=f.getComponentSize();s+=E.padNumber(v*l),o.accessorIndexMap.set(f,e.accessors.length),e.accessors.push(c)}for(var d=u*s,w=new ArrayBuffer(d),p=new DataView(w),x=0;x<u;x++)for(var y,A=0,m=a(t);!(y=m()).done;){for(var b=y.value,T=b.getElementSize(),I=b.getComponentSize(),g=b.getComponentType(),M=b.getArray(),S=0;S<T;S++){var R=x*s+A+S*I,N=M[x*T+S];switch(g){case C.ComponentType.FLOAT:p.setFloat32(R,N,!0);break;case C.ComponentType.BYTE:p.setInt8(R,N);break;case C.ComponentType.SHORT:p.setInt16(R,N,!0);break;case C.ComponentType.UNSIGNED_BYTE:p.setUint8(R,N);break;case C.ComponentType.UNSIGNED_SHORT:p.setUint16(R,N,!0);break;case C.ComponentType.UNSIGNED_INT:p.setUint32(R,N,!0);break;default:throw new Error("Unexpected component type: "+g)}}A+=E.padNumber(T*I)}return e.bufferViews.push({buffer:n,byteOffset:r,byteLength:d,byteStride:s,target:It.BufferViewTarget.ARRAY_BUFFER}),{byteLength:d,buffers:[w]}}for(var x,y=new Map,A=a(t.getGraph().getLinks());!(x=A()).done;){var m=x.value;if(m.getParent()!==i){var b=m.getChild();if(b instanceof C){var T=y.get(b)||[];T.push(m),y.set(b,T)}}}if(e.accessors=[],e.bufferViews=[],e.samplers=[],e.textures=[],e.images=i.listTextures().map(function(t,n){var r=o.createPropertyDef(t);t.getMimeType()&&(r.mimeType=t.getMimeType());var i=t.getImage();return i&&o.createImageData(r,i,t),o.imageIndexMap.set(t,n),r}),t.getRoot().listExtensionsUsed().filter(function(t){return t.prewriteTypes.includes(exports.PropertyType.ACCESSOR)}).forEach(function(t){return t.prewrite(o,exports.PropertyType.ACCESSOR)}),i.listAccessors().forEach(function(t){var n=o.accessorUsageGroupedByParent,r=o.accessorParents;if(!o.accessorIndexMap.has(t)){var i=y.get(t)||[],e=o.getAccessorUsage(t);if(o.addAccessorToUsageGroup(t,e),n.has(e)){var u=i[0].getParent(),s=r.get(u)||new Set;s.add(t),r.set(u,s)}}}),i.listExtensionsUsed().filter(function(t){return t.prewriteTypes.includes(exports.PropertyType.BUFFER)}).forEach(function(t){return t.prewrite(o,exports.PropertyType.BUFFER)}),(i.listAccessors().length>0||i.listTextures().length>0||o.otherBufferViews.size>0)&&0===i.listBuffers().length)throw new Error("Buffer required for Document resources, but none was found.");e.buffers=[],i.listBuffers().forEach(function(t,r){var i,s=o.createPropertyDef(t),h=o.accessorUsageGroupedByParent,f=o.accessorParents,c=t.listParents().filter(function(t){return t instanceof C}),v=new Set(c),l=[],d=e.buffers.length,x=0,y=o.listAccessorUsageGroups(),A=function(t){if(h.has(t))for(var r=0,i=Array.from(f.values());r<i.length;r++){var e=Array.from(i[r]).filter(function(t){return v.has(t)}).filter(function(n){return o.getAccessorUsage(n)===t});if(e.length)if(t!==St.ARRAY_BUFFER||n.vertexLayout===exports.VertexLayout.INTERLEAVED){var u=t===St.ARRAY_BUFFER?p(e,d,x):w(e,d,x);x+=u.byteLength,l.push.apply(l,u.buffers)}else for(var s,c=a(e);!(s=c()).done;){var A=p([s.value],d,x);x+=A.byteLength,l.push.apply(l,A.buffers)}}else{var E=y[t].filter(function(t){return v.has(t)});if(!E.length)return"continue";var m=w(E,d,x,t===St.ELEMENT_ARRAY_BUFFER?It.BufferViewTarget.ELEMENT_ARRAY_BUFFER:void 0);x+=m.byteLength,l.push.apply(l,m.buffers)}};for(var m in y)A(m);if(o.imageBufferViews.length&&0===r)for(var b=0;b<o.imageBufferViews.length;b++)if(e.bufferViews[e.images[b].bufferView].byteOffset=x,x+=o.imageBufferViews[b].byteLength,l.push(o.imageBufferViews[b]),x%8){var T=8-x%8;x+=T,l.push(new ArrayBuffer(T))}if(o.otherBufferViews.has(t))for(var I,g=a(o.otherBufferViews.get(t));!(I=g()).done;){var M=I.value;e.bufferViews.push({buffer:d,byteOffset:x,byteLength:M.byteLength}),o.otherBufferViewsIndexMap.set(M,e.bufferViews.length-1),x+=M.byteLength,l.push(M)}x&&(n.format===exports.Format.GLB?i="@glb.bin":(i=o.bufferURIGenerator.createURI(t,"bin"),s.uri=i),s.byteLength=x,u.resources[i]=E.concat(l)),e.buffers.push(s),o.bufferIndexMap.set(t,r)}),i.listAccessors().find(function(t){return!t.getBuffer()})&&h.warn("Skipped writing one or more Accessors: no Buffer assigned."),e.materials=i.listMaterials().map(function(t,n){var r=o.createPropertyDef(t);if(t.getAlphaMode()!==tt.AlphaMode.OPAQUE&&(r.alphaMode=t.getAlphaMode()),t.getAlphaMode()===tt.AlphaMode.MASK&&(r.alphaCutoff=t.getAlphaCutoff()),t.getDoubleSided()&&(r.doubleSided=!0),r.pbrMetallicRoughness={},S.eq(t.getBaseColorFactor(),[1,1,1,1])||(r.pbrMetallicRoughness.baseColorFactor=t.getBaseColorFactor()),S.eq(t.getEmissiveFactor(),[0,0,0])||(r.emissiveFactor=t.getEmissiveFactor()),1!==t.getRoughnessFactor()&&(r.pbrMetallicRoughness.roughnessFactor=t.getRoughnessFactor()),1!==t.getMetallicFactor()&&(r.pbrMetallicRoughness.metallicFactor=t.getMetallicFactor()),t.getBaseColorTexture()){var i=t.getBaseColorTexture(),e=t.getBaseColorTextureInfo();r.pbrMetallicRoughness.baseColorTexture=o.createTextureInfoDef(i,e)}if(t.getEmissiveTexture()){var u=t.getEmissiveTexture(),s=t.getEmissiveTextureInfo();r.emissiveTexture=o.createTextureInfoDef(u,s)}if(t.getNormalTexture()){var h=t.getNormalTexture(),f=t.getNormalTextureInfo(),c=o.createTextureInfoDef(h,f);1!==t.getNormalScale()&&(c.scale=t.getNormalScale()),r.normalTexture=c}if(t.getOcclusionTexture()){var a=t.getOcclusionTexture(),v=t.getOcclusionTextureInfo(),l=o.createTextureInfoDef(a,v);1!==t.getOcclusionStrength()&&(l.strength=t.getOcclusionStrength()),r.occlusionTexture=l}if(t.getMetallicRoughnessTexture()){var d=t.getMetallicRoughnessTexture(),w=t.getMetallicRoughnessTextureInfo();r.pbrMetallicRoughness.metallicRoughnessTexture=o.createTextureInfoDef(d,w)}return o.materialIndexMap.set(t,n),r}),e.meshes=i.listMeshes().map(function(t,n){var r=o.createPropertyDef(t),i=null;return r.primitives=t.listPrimitives().map(function(t){var n={attributes:{}};n.mode=t.getMode();var r=t.getMaterial();r&&(n.material=o.materialIndexMap.get(r)),Object.keys(t.getExtras()).length&&(n.extras=t.getExtras());var e=t.getIndices();e&&(n.indices=o.accessorIndexMap.get(e));for(var u,s=a(t.listSemantics());!(u=s()).done;){var h=u.value;n.attributes[h]=o.accessorIndexMap.get(t.getAttribute(h))}for(var f,c=a(t.listTargets());!(f=c()).done;){for(var v,l=f.value,d={},w=a(l.listSemantics());!(v=w()).done;){var p=v.value;d[p]=o.accessorIndexMap.get(l.getAttribute(p))}n.targets=n.targets||[],n.targets.push(d)}return t.listTargets().length&&!i&&(i=t.listTargets().map(function(t){return t.getName()})),n}),t.getWeights().length&&(r.weights=t.getWeights()),i&&(r.extras=r.extras||{},r.extras.targetNames=i),o.meshIndexMap.set(t,n),r}),e.cameras=i.listCameras().map(function(t,n){var r=o.createPropertyDef(t);if(r.type=t.getType(),r.type===V.Type.PERSPECTIVE){r.perspective={znear:t.getZNear(),zfar:t.getZFar(),yfov:t.getYFov()};var i=t.getAspectRatio();null!==i&&(r.perspective.aspectRatio=i)}else r.orthographic={znear:t.getZNear(),zfar:t.getZFar(),xmag:t.getXMag(),ymag:t.getYMag()};return o.cameraIndexMap.set(t,n),r}),e.nodes=i.listNodes().map(function(t,n){var r=o.createPropertyDef(t);return S.eq(t.getTranslation(),[0,0,0])||(r.translation=t.getTranslation()),S.eq(t.getRotation(),[0,0,0,1])||(r.rotation=t.getRotation()),S.eq(t.getScale(),[1,1,1])||(r.scale=t.getScale()),t.getWeights().length&&(r.weights=t.getWeights()),o.nodeIndexMap.set(t,n),r}),e.skins=i.listSkins().map(function(t,n){var r=o.createPropertyDef(t),i=t.getInverseBindMatrices();i&&(r.inverseBindMatrices=o.accessorIndexMap.get(i));var e=t.getSkeleton();return e&&(r.skeleton=o.nodeIndexMap.get(e)),r.joints=t.listJoints().map(function(t){return o.nodeIndexMap.get(t)}),o.skinIndexMap.set(t,n),r}),i.listNodes().forEach(function(t,n){var r=e.nodes[n],i=t.getMesh();i&&(r.mesh=o.meshIndexMap.get(i));var u=t.getCamera();u&&(r.camera=o.cameraIndexMap.get(u));var s=t.getSkin();s&&(r.skin=o.skinIndexMap.get(s)),t.listChildren().length>0&&(r.children=t.listChildren().map(function(t){return o.nodeIndexMap.get(t)}))}),e.animations=i.listAnimations().map(function(t){var n=o.createPropertyDef(t),r=new Map;return n.samplers=t.listSamplers().map(function(t,n){var i=o.createPropertyDef(t);return i.input=o.accessorIndexMap.get(t.getInput()),i.output=o.accessorIndexMap.get(t.getOutput()),i.interpolation=t.getInterpolation(),r.set(t,n),i}),n.channels=t.listChannels().map(function(t){var n=o.createPropertyDef(t);return n.sampler=r.get(t.getSampler()),n.target={node:o.nodeIndexMap.get(t.getTargetNode()),path:t.getTargetPath()},n}),n}),e.scenes=i.listScenes().map(function(t){var n=o.createPropertyDef(t);return n.nodes=t.listChildren().map(function(t){return o.nodeIndexMap.get(t)}),n});var I=i.getDefaultScene();return I&&(e.scene=i.listScenes().indexOf(I)),e.extensionsUsed=i.listExtensionsUsed().map(function(t){return t.extensionName}),e.extensionsRequired=i.listExtensionsRequired().map(function(t){return t.extensionName}),i.listExtensionsUsed().forEach(function(t){return t.write(o)}),function(t){var n=[];for(var r in t){var i=t[r];(Array.isArray(i)&&0===i.length||null===i||""===i||i&&"object"==typeof i&&0===Object.keys(i).length)&&n.push(r)}for(var e=0,u=n;e<u.length;e++)delete t[u[e]]}(e),u},t}();!function(t){t[t.JSON=1313821514]="JSON",t[t.BIN=5130562]="BIN"}(gt||(gt={}));var Nt=function(){function t(){this.Ut=R.DEFAULT_INSTANCE,this.xt=[],this.Ct={},this.kt=exports.VertexLayout.INTERLEAVED}var n=t.prototype;return n.setLogger=function(t){return this.Ut=t,this},n.registerExtensions=function(t){for(var n,r=a(t);!(n=r()).done;){var i=n.value;this.xt.push(i),i.register()}return this},n.registerDependencies=function(t){return Object.assign(this.Ct,t),this},n.setVertexLayout=function(t){return this.kt=t,this},n.Ft=function(t){function n(n){if(n.uri&&!(n.uri in t.resources)&&n.uri.match(/data:/)){var r="__"+P()+"."+b.extension(n.uri);t.resources[r]=E.createBufferFromDataURI(n.uri),n.uri=r}}(t.json.images||[]).forEach(function(t){if(void 0===t.bufferView&&void 0===t.uri)throw new Error("Missing resource URI or buffer view.");n(t)}),(t.json.buffers||[]).forEach(n)},n.readJSON=function(t){return this.Ft(t),bt.read(t,{extensions:this.xt,dependencies:this.Ct,logger:this.Ut})},n.writeJSON=function(t,n){if(void 0===n&&(n={}),n.format===exports.Format.GLB&&t.getRoot().listBuffers().length>1)throw new Error("GLB must have 01 buffers.");return Rt.write(t,{format:n.format||exports.Format.GLTF,logger:n.logger||this.Ut,vertexLayout:n.vertexLayout||this.kt,dependencies:s({},this.Ct,n.dependencies),basename:n.basename||""})},n.binaryToJSON=function(t){var n=this.Dt(t),r=n.json;if(r.buffers&&r.buffers.find(function(t){return void 0!==t.uri}))throw new Error("Cannot resolve external buffers with binaryToJSON().");if(r.images&&r.images.find(function(t){return void 0===t.bufferView}))throw new Error("Cannot resolve external images with binaryToJSON().");return n},n.Dt=function(t){var n,r=new Uint32Array(t,0,3);if(1179937895!==r[0])throw new Error("Invalid glTF asset.");if(2!==r[1])throw new Error('Unsupported glTF binary version, "'+r[1]+'".');var i=new Uint32Array(t,12,2);if(i[1]!==gt.JSON)throw new Error("Missing required GLB JSON chunk.");var e=i[0],u=E.decodeText(t.slice(20,20+e)),s=JSON.parse(u),o=20+e;if(t.byteLength<=o)return{json:s,resources:{}};var h=new Uint32Array(t,o,2);if(h[1]!==gt.BIN)throw new Error("Expected GLB BIN in second chunk.");var f=t.slice(o+8,o+8+h[0]);return{json:s,resources:(n={},n["@glb.bin"]=f,n)}},n.readBinary=function(t){return this.readJSON(this.binaryToJSON(t))},n.writeBinary=function(t){var n=this.writeJSON(t,{format:exports.Format.GLB,basename:"",logger:this.Ut,dependencies:this.Ct,vertexLayout:this.kt}),r=n.json,i=n.resources,e=new Uint32Array([1179937895,2,12]),u=JSON.stringify(r),s=E.pad(E.encodeText(u),32),o=new Uint32Array([s.byteLength,1313821514]).buffer,h=E.concat([o,s]);e[e.length-1]+=h.byteLength;var f=Object.values(i)[0];if(!f||!f.byteLength)return E.concat([e.buffer,h]);var c=E.pad(f,0),a=new Uint32Array([c.byteLength,5130562]).buffer,v=E.concat([a,c]);return e[e.length-1]+=v.byteLength,E.concat([e.buffer,h,v])},t}(),Ot=function(t){function n(){var n;return(n=t.call(this)||this).Gt=void 0,n.Jt=void 0,n.lastReadBytes=0,n.lastWriteBytes=0,n.Gt=require("fs"),n.Jt=require("path"),n}o(n,t);var r=n.prototype;return r.read=function(t){var n=this.readAsJSON(t);return bt.read(n,{extensions:this.xt,dependencies:this.Ct,logger:this.Ut})},r.readAsJSON=function(t){return t.match(/\.glb$/)||t.match(/^data:application\/octet-stream;/)?this.Vt(t):this.qt(t)},r.write=function(t,n){t.match(/\.glb$/)?this.Yt(t,n):this.zt(t,n)},r.Ht=function(t,n){var r=this;[].concat(t.json.images||[],t.json.buffers||[]).forEach(function(i){if(i.uri&&!i.uri.match(/data:/)){var e=r.Jt.resolve(n,i.uri);t.resources[i.uri]=E.trim(r.Gt.readFileSync(e)),r.lastReadBytes+=t.resources[i.uri].byteLength}})},r.Vt=function(t){var n=this.Gt.readFileSync(t),r=E.trim(n);this.lastReadBytes=r.byteLength;var i=this.Dt(r);return this.Ht(i,this.Jt.dirname(t)),this.Ft(i),i},r.qt=function(t){this.lastReadBytes=0;var n=this.Gt.readFileSync(t,"utf8");this.lastReadBytes+=n.length;var r={json:JSON.parse(n),resources:{}};return this.Ht(r,this.Jt.dirname(t)),this.Ft(r),r},r.zt=function(t,n){var r=this;this.lastWriteBytes=0;var i=Rt.write(n,{format:exports.Format.GLTF,logger:this.Ut,dependencies:this.Ct,vertexLayout:this.kt,basename:b.basename(t)}),e=i.json,u=i.resources,s=this.Gt,o=this.Jt,h=o.dirname(t),f=JSON.stringify(e,null,2);this.lastWriteBytes+=f.length,s.writeFileSync(t,f),Object.keys(u).forEach(function(t){var n=Buffer.from(u[t]);s.writeFileSync(o.join(h,t),n),r.lastWriteBytes+=n.byteLength})},r.Yt=function(t,n){var r=Buffer.from(this.writeBinary(n));this.Gt.writeFileSync(t,r),this.lastWriteBytes=r.byteLength},n}(Nt),Lt={},Pt=function(t){function n(n){var r;return void 0===n&&(n=Lt),(r=t.call(this)||this).$t=void 0,r.$t=n,r}o(n,t);var r=n.prototype;return r.read=function(t){var n=this;return this.readAsJSON(t).then(function(t){return n.readJSON(t)})},r.readAsJSON=function(t){return t.match(/^data:application\/octet-stream;/)||new URL(t,window.location.href).pathname.match(/\.glb$/)?this.Vt(t):this.qt(t)},r.Ht=function(t,n){var r=this,i=[].concat(t.json.images||[],t.json.buffers||[]).map(function(i){var e=i.uri;return!e||e.match(/data:/)?Promise.resolve():fetch(function(t,n){if(!function(t){return!/^(?:[a-zA-Z]+:)?\//.test(t)}(n))return n;var r=t.split("/"),i=n.split("/");r.pop();for(var e=0;e<i.length;e++)"."!==i[e]&&(".."===i[e]?r.pop():r.push(i[e]));return r.join("/")}(n,e),r.$t).then(function(t){return t.arrayBuffer()}).then(function(n){t.resources[e]=n})});return Promise.all(i).then(function(){})},r.qt=function(t){var n=this,r={json:{},resources:{}};return fetch(t,this.$t).then(function(t){return t.json()}).then(function(i){try{return r.json=i,Promise.resolve(n.Ht(r,_t(t))).then(function(){return n.Ft(r),r})}catch(t){return Promise.reject(t)}})},r.Vt=function(t){var n=this;return fetch(t,this.$t).then(function(t){return t.arrayBuffer()}).then(function(r){try{var i=n.Dt(r);return Promise.resolve(n.Ht(i,_t(t))).then(function(){return n.Ft(i),i})}catch(t){return Promise.reject(t)}})},n}(Nt);function _t(t){var n=t.lastIndexOf("/");return-1===n?"./":t.substr(0,n+1)}exports.Accessor=C,exports.Animation=F,exports.AnimationChannel=D,exports.AnimationSampler=G,exports.AttributeLink=Y,exports.Buffer=J,exports.BufferUtils=E,exports.COPY_IDENTITY=_,exports.Camera=V,exports.ColorUtils=m,exports.Document=dt,exports.Extension=wt,exports.ExtensionProperty=q,exports.FileUtils=b,exports.GLB_BUFFER="@glb.bin",exports.Graph=d,exports.GraphChild=w,exports.GraphChildList=p,exports.ImageUtils=g,exports.IndexLink=z,exports.Link=l,exports.Logger=R,exports.Material=tt,exports.MathUtils=S,exports.Mesh=nt,exports.Node=rt,exports.NodeIO=Ot,exports.PlatformIO=Nt,exports.Primitive=it,exports.PrimitiveTarget=et,exports.Property=U,exports.ReaderContext=At,exports.Root=ht,exports.Scene=ut,exports.Skin=st,exports.Texture=ot,exports.TextureInfo=K,exports.TextureLink=H,exports.VERSION="v0.12.16",exports.WebIO=Pt,exports.WriterContext=It,exports.bounds=function(t){for(var n,r={min:[Infinity,Infinity,Infinity],max:[-Infinity,-Infinity,-Infinity]},i=a(t.propertyType===exports.PropertyType.NODE?[t]:t.listChildren());!(n=i()).done;)n.value.traverse(function(t){var n=t.getMesh();if(n){var i=y(n,t.getWorldMatrix());A(i.min,r),A(i.max,r)}});return r},exports.uuid=P;
//# sourceMappingURL=core.js.map
